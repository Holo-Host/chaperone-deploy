(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{2:function(e,t,n){"use strict";(function(e,s){var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(o,i){function r(e){try{h(s.next(e))}catch(e){i(e)}}function a(e){try{h(s.throw(e))}catch(e){i(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}h((s=s.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,s,o,i,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(o=2&i[0]?s.return:i[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,i[1])).done)return o;switch(s=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,s=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){r.label=i[1];break}if(6===i[0]&&r.label<o[1]){r.label=o[1],o=i;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(i);break}o[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],s=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},h=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var s=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],r=0,a=i.length;r<a;r++,o++)s[o]=i[r];return s},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0;var u=c(n(27)),l=c(n(51)),d=n(55);t.Codec=d.Codec,t.sha256=d.sha256,t.KeyManager=d.KeyManager;var g=n(22),p=(g.TimeoutError,"object"==typeof window&&"Window"===window.constructor.name),f=n(67).COMB;t.COMB=f;var v=e.crypto||window.crypto,w=e.fetch||window.fetch;var m=function(e){function t(n){for(var s=[],o=1;o<arguments.length;o++)s[o-1]=arguments[o];var i=e.call(this,n)||this;return Error.captureStackTrace&&Error.captureStackTrace(i,t),i.name="HoloError",i}return i(t,e),t}(Error);function y(e,t,n){return r(this,void 0,void 0,(function(){var s,o;return a(this,(function(i){switch(i.label){case 0:return s={happ_id:e,new_agent:n},!1===t?s.anonymous=!0:s.agent_id=t,[4,w("https://resolver-dev.holo.host/resolve/hosts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})];case 1:return[4,i.sent().json()];case 2:return o=i.sent(),[2,(r=o.hosts,r[Math.floor(Math.random()*r.length)])]}var r}))}))}function _(e){return r(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:if("string"!=typeof e)throw new Error("Bad input: hostname paramater '"+e+"' (typeof "+typeof e+") must be a string");return[4,w("https://resolver-dev.holo.host/resolve/happId",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e})})];case 1:return[4,t.sent().json()];case 2:return[2,t.sent().happ_id]}}))}))}function b(e,t,n){return r(this,void 0,void 0,(function(){var s,o,i;return a(this,(function(r){switch(r.label){case 0:if(!e||!t)throw new Error("Missing parameter");return s={agent_id:e,host_id:t},o=(new Date).toISOString(),[4,w("https://resolver-dev.holo.host/update/assignHost",{method:"POST",headers:{"Content-Type":"application/json",Authorization:n({params:s,date:o}),Date:o},body:JSON.stringify(s)})];case 1:return[2,200===(i=r.sent()).status||i.status]}}))}))}t.HoloError=m;var C=function(){function e(t){if(void 0===t&&(t=e.DEFAULTS),this.anonymous=!0,this.agent_overrides={},this.opened=!1,this.wormhole_ready=!1,this.wormhole_listeners={},this.pending_confirms={},this.opts=Object.assign({},e.DEFAULTS,t),this.logMessage("Initialized with opts:",this.opts),this.port=this.opts.port,this.mode=this.opts.mode,this.COMB=f,this.window=window,!this.COMB||"function"!=typeof this.COMB.connect||"function"!=typeof this.COMB.listen)throw new Error("COMB is not the library we expected");!0===this.opts.comb&&this.setupCOMBListeners(),this.init(this.opts.timeout).catch((function(e){return console.log(String(e))}))}return e.prototype.alertParent=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return r(this,void 0,void 0,(function(){var n;return a(this,(function(s){if(!0===this.opts.comb){if(!this.parent_window)return[2];this.logMessage("Sending alert to parent window:",e,t),(n=this.parent_window.msg_bus).emit.apply(n,h(["alert",e],t))}return[2]}))}))},e.prototype.setupCOMBListeners=function(){return r(this,void 0,void 0,(function(){var e,t,n,s=this;return a(this,(function(o){switch(o.label){case 0:return e=this,t=window,this.logMessage("Setting up COMB listeners"),n=this,[4,this.COMB.listen({signUp:function(){return r(s,void 0,void 0,(function(){var n;return a(this,(function(s){switch(s.label){case 0:return e.logMessage("Sign-up was called"),!1===this.anonymous?[2,!1]:(t.showSignUp(),[4,this.getCredentials()]);case 1:return n=s.sent(),console.log("Credentials",n),[4,this.signUp(n.email,n.password)];case 2:return[2,s.sent()]}}))}))},signIn:function(){return r(s,void 0,void 0,(function(){var n;return a(this,(function(s){switch(s.label){case 0:return e.logMessage("Sign-in was called"),!1===this.anonymous?[2,!1]:(t.showSignIn(),[4,this.getCredentials()]);case 1:return n=s.sent(),console.log("Credentials",n),[4,this.signIn(n.email,n.password)];case 2:return[2,s.sent()]}}))}))},signOut:function(){return r(s,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return e.logMessage("Sign-out was called"),!0===this.anonymous?[2,!1]:(this.window.localStorage.removeItem("seed"),[4,this.signOut()]);case 1:return[2,t.sent()]}}))}))},zomeCall:function(t,n,o,i){return void 0===i&&(i={}),r(s,void 0,void 0,(function(){return a(this,(function(s){switch(s.label){case 0:return e.logMessage("zomeCall was called"),[4,this.callZomeFunction(t,n,o,i)];case 1:return[2,s.sent()]}}))}))}})];case 1:return n.parent_window=o.sent(),this.logMessage("COMB parent is connected"),[2]}}))}))},e.prototype.getCredentials=function(){return r(this,void 0,void 0,(function(){var e,t,n,s,o;return a(this,(function(i){return e=window,t=e.$,n=t("#modal"),s={$email:t("#email"),$password:t("#password")},o={$email:t("#signup-email"),$password:t("#signup-password"),$confirm:t("#signup-password-confirm"),$confirmFeedback:t("#signup-password-confirm-feedback")},[2,new Promise((function(t,i){e.formSubmit=function(){var i={email:null,password:null};if("signin"===e.expect)i.email=s.$email.val(),i.password=s.$password.val(),s.$email.addClass("is-valid"),s.$password.addClass("is-valid");else if("signup"===e.expect){if(o.$password.val()!==o.$confirm.val())return o.$confirmFeedback.text("Passwords do not match. Please try again."),void o.$confirm.addClass("is-invalid");i.email=o.$email.val(),i.password=o.$password.val(),o.$email.addClass("is-valid"),o.$password.addClass("is-valid"),o.$confirm.addClass("is-valid")}t(i),n.modal("hide"),s.$email.removeClass("is-valid is-invalid").val(""),s.$password.removeClass("is-valid is-invalid").val(""),o.$email.removeClass("is-valid is-invalid").val(""),o.$password.removeClass("is-valid is-invalid").val(""),o.$confirm.removeClass("is-valid is-invalid").val("")},n.modal("show")}))]}))}))},e.prototype.init=function(t){return void 0===t&&(t=5e3),r(this,void 0,void 0,(function(){var n,s,o,i;return a(this,(function(r){switch(r.label){case 0:return this.mode===e.HCC&&(void 0!==this.opts.web_user_legend?this.agent_overrides=this.opts.web_user_legend:void 0===this.opts.agent_id&&console.log("WARNING: this Chaperone has no configured users")),this.opts.agent_id?this.agent_id=this.opts.agent_id:this.window.localStorage.getItem("seed")?(n=this.window.localStorage.getItem("seed"),this.mode===e.HCC&&n in this.agent_overrides?(this.agent_id=this.agent_overrides[n],this.anonymous=!1):(s=d.Codec.Digest.decode(n),this.createAgentFromSeed(s))):this.createAnonymousAgent(),this.mode!==e.DEVELOP&&this.mode!==e.HCC?[3,1]:(this.hha_hash="QmV1NgkXFwromLvyAmASN7MbgLtgUaEYkozHPGUxcHAbSL",this.instance_prefix=this.opts.instance_prefix,[3,3]);case 1:return o=this.happHost(),i=this,[4,_(o)];case 2:i.hha_hash=r.sent(),this.instance_prefix=this.hha_hash,r.label=3;case 3:return"undefined"===this.opts.host&&(this.opts.host=window.location.hostname),this.logMessage("Initialize Chaperone",this.COMB),[4,this.connect(!1,t)];case 4:return r.sent(),[2]}}))}))},e.prototype.connect=function(t,n){return void 0===t&&(t=!1),void 0===n&&(n=5e3),r(this,void 0,void 0,(function(){var s,o,i,r,h,c,l,d,g;return a(this,(function(a){switch(a.label){case 0:if(this.logMessage("Connecting..."),this.logMessage("New_agent is ",t),!0===this.opened)throw new Error("Connection already open, run `await this.disconnect()` before starting a new connection.");if(!this.opts.host)return[3,1];if(this.mode===e.PRODUCT&&"localhost"===this.opts.host&&void 0===this.opts.host_agent_id)throw new Error("Cannot set 'host' to localhost without setting 'host_agent_id' also");return this.logMessage("Host has been overridden in configuration with:",this.opts.host),this.host=this.opts.host,[3,3];case 1:return this.logMessage("Resolve hosts for Agent:",this.agent_id),s=this,[4,y(this.hha_hash,!0!==this.anonymous&&this.agent_id,t)];case 2:s.host=a.sent(),this.logMessage("Host retrieved from Resolver:",this.host),a.label=3;case 3:return o=this.opts.path,i=!0===this.opts.ssl?"wss":"ws",r=i+"://"+this.host+":"+this.port+o+"?anonymous="+this.anonymous+"&agent_id="+this.agent_id+"&hha_hash="+this.hha_hash,this.logMessage("Connecting to",r),this.conn=new u.default(r),[4,this.conn.opened(n)];case 4:if(a.sent(),this.opened=!0,this.alertParent("connected"),this.mode===e.HCC)return this.wormhole_ready=!0,[2];if(!1!==this.anonymous)return[3,16];a.label=5;case 5:return a.trys.push([5,14,,16]),[4,this.handleWormholeRequests()];case 6:return a.sent(),this.logMessage("Is this a new agent?",t),t?(this.logMessage("Calling sign-up for new agent"),[4,this.conn.call("holo/agent/signup",[this.hha_hash,this.agent_id])]):[3,9];case 7:if(!0!==(h=a.sent()))throw this.logMessage("Error:",h),new m("Failed to sign-up");return this.logMessage("Saving assigned host for agent"),[4,b(this.agent_id,this.host,this.getSignature.bind(this))];case 8:if(!0!==(c=a.sent()))throw this.logMessage("Error while saving assignedHost:",c),new m("Failed to save assignedHost");return this.logMessage("Assigned host saved"),this.alertParent("signup"),[3,13];case 9:l=void 0,a.label=10;case 10:return a.trys.push([10,12,,13]),[4,this.conn.call("holo/agent/identify",[this.agent_id])];case 11:if(!0!==(l=a.sent()))throw l;return this.alertParent("signin"),[3,13];case 12:throw(d=a.sent()).message.toLowerCase().includes("unknown to this host")?new m("Wrong Host.  Host "+this.host+" cannot identify agent "+this.agent_id):new m("Identify Error: "+JSON.stringify(d));case 13:return[3,16];case 14:return g=a.sent(),this.logMessage("Sign-in/up failed",g),[4,this.signOut()];case 15:throw a.sent(),g;case 16:return[2]}}))}))},e.prototype.disconnect=function(){return r(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return!1===this.opened?[2]:(this.conn.close(),[4,this.conn.closed()]);case 1:return e.sent(),this.opened=!1,this.wormhole_ready=!1,this.alertParent("disconnected"),[2]}}))}))},e.prototype.ready=function(e){return void 0===e&&(e=5e3),r(this,void 0,void 0,(function(){var t,n=this;return a(this,(function(s){switch(s.label){case 0:return s.trys.push([0,,2,3]),[4,g((function(){return r(n,void 0,void 0,(function(){var e=this;return a(this,(function(n){return[2,new Promise((function(n,s){t=setInterval((function(){return r(e,void 0,void 0,(function(){return a(this,(function(e){return this.logMessage("Checking ready state..."),this.conn?!0!==this.opened?[2,this.logMessage("WebSocket is not open")]:!1===this.anonymous&&!0!==this.wormhole_ready?[2,this.logMessage("Wormhole is not ready")]:(n(this),[2]):[2,this.logMessage("this.conn is not defined")]}))}))}),100)}))]}))}))}),e)];case 1:return[2,s.sent()];case 2:return clearInterval(t),[7];case 3:return[2]}}))}))},e.prototype.wormholeRequest=function(e){var t=this;return new Promise((function(n,s){t.wormhole_listeners[e]=[n,s]}))},e.prototype.handleWormholeRequests=function(){return r(this,void 0,void 0,(function(){var t,n,s=this;return a(this,(function(o){switch(o.label){case 0:if(this.mode===e.HCC)return this.wormhole_ready=!0,[2];this.logMessage("Register Agent:",this.agent_id),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.conn.call("holo/wormhole/event",[this.agent_id])];case 2:return t=o.sent(),[3,4];case 3:if(n=o.sent(),console.log(String(n)),!n.message.includes("unknown to this host"))throw new m("RPC Error: "+JSON.stringify(n));return this.logMessage("WARNING: this host does not know this Agent identity. Sign-up must be the next call."),[3,4];case 4:if(this.logMessage("Signing request event:",t),"string"!=typeof t)throw"HoloError"===t.name?new m(t.message):new m("Unexpected response from Host: "+JSON.stringify(t));return this.logMessage("Subscribe to",t),[4,this.conn.subscribe(t)];case 5:return o.sent(),this.logMessage("Register listener on",t),this.conn.on(t,(function(e,t){return r(s,void 0,void 0,(function(){var n,s,o,i;return a(this,(function(r){switch(r.label){case 0:return this.logMessage("Signing log: received -",e,t),n=this.getSignature(t),this.logMessage("Signing log: sending -",e,n),[4,this.conn.call("holo/wormhole/response",[e,n])];case 1:return!0!==(s=r.sent())&&console.error("holo/wormhole/response failed:",s),void 0!==this.wormhole_listeners[e]&&(o=this.wormhole_listeners[e],i=o[0],o[1],this.logMessage("Trigger wormhole listener",e),i([n,t]),delete this.wormhole_listeners[e]),[2]}}))}))})),this.logMessage("Wormhole is ready"),this.wormhole_ready=!0,[2]}}))}))},e.prototype.createAnonymousAgent=function(){try{this.seed=function(e){if(void 0===e&&(e=32),p){var t=new Uint8Array(e);return window.crypto.getRandomValues(t),t}return v.randomBytes(e)}(32),this.keys=new d.KeyManager(this.seed),this.agent_id=d.Codec.AgentId.encode(this.keys.publicKey()),this.anonymous=!0}catch(e){this.logMessage("Failed to create anonymous agent"),console.log(String(e))}},e.prototype.createAgentFromSeed=function(e){this.logMessage("Creating agent from stored seed");try{this.seed=e,this.keys=new d.KeyManager(this.seed),this.agent_id=d.Codec.AgentId.encode(this.keys.publicKey()),this.anonymous=!1}catch(e){this.logMessage("Failed to create anonymous agent"),console.log(String(e))}},e.prototype.deriveAgent=function(e,t){if(e in this.agent_overrides)return this.agent_id=this.agent_overrides[e],this.anonymous=!1,void this.window.localStorage.setItem("seed",e);if(this.opts.agent_id)this.anonymous=!1;else try{this.seed=s.from(d.deriveSeedFrom(d.Codec.Digest.decode(this.hha_hash),e,t)),this.window.localStorage.setItem("seed",d.Codec.Digest.encode(this.seed)),this.keys=new d.KeyManager(this.seed),this.agent_id=d.Codec.AgentId.encode(this.keys.publicKey()),this.anonymous=!1}catch(e){this.logMessage("Failed to create anonymous agent"),console.log(String(e))}},e.prototype.signUp=function(e,t,n){var s=(void 0===n?{}:n).timeout,o=void 0===s?5e3:s;return r(this,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return console.log("Calling signUp method..."),this.deriveAgent(e,t),[4,this.disconnect()];case 1:return n.sent(),[4,this.connect(!0,o)];case 2:return n.sent(),[2,!1===this.anonymous]}}))}))},e.prototype.signIn=function(e,t,n){var s=(void 0===n?{}:n).timeout,o=void 0===s?5e3:s;return r(this,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return console.log("Calling signIn method..."),this.deriveAgent(e,t),[4,this.disconnect()];case 1:return n.sent(),[4,this.connect(!1,o)];case 2:return n.sent(),[2,!1===this.anonymous]}}))}))},e.prototype.signOut=function(e){var t=(void 0===e?{}:e).timeout,n=void 0===t?5e3:t;return r(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return this.createAnonymousAgent(),[4,this.disconnect()];case 1:return e.sent(),this.alertParent("signout"),[4,this.connect(!1,n)];case 2:return e.sent(),[2,!0===this.anonymous]}}))}))},e.prototype.callZomeFunction=function(t,n,s,o){return void 0===o&&(o={}),r(this,void 0,void 0,(function(){var i,r,h,c,u,l,d,g,p,f,v,w;return a(this,(function(a){switch(a.label){case 0:return[4,this.ready()];case 1:if(a.sent(),"string"!=typeof(i=this.instance_prefix))throw new Error("Instance prefix should be a string.  Found '"+i+"' ("+typeof i+")");return r={instance_id:i+"::"+t,zome:n,function:s,args:o},!1===this.anonymous&&(r.instance_id=i+"::"+this.agent_id+"-"+t),this.mode!==e.HCC?[3,3]:[4,this.conn.call("call",r)];case 2:return[2,a.sent()];case 3:return r.hha_hash=this.hha_hash,r.dna_alias=t,h={timestamp:(new Date).toISOString().replace("Z","+00:00"),host_id:this.hostId(),call_spec:r},[4,this.requestServiceSignature(h)];case 4:c=a.sent(),this.logMessage("Serialized Signature:",c),u={anonymous:this.anonymous,agent_id:this.agent_id,payload:h,service_signature:c},a.label=5;case 5:return a.trys.push([5,7,,8]),[4,this.conn.call("holo/call",u)];case 6:return l=a.sent(),[3,8];case 7:throw d=a.sent(),g="Error type unknown: "+d.constructor,d instanceof Error?g=String(d):-32e3===d.code&&(g=d.message+": "+d.data),this.logMessage(d),new m("RPC request threw error: "+g);case 8:if(p=l.response_id,f=l.error,v=l.result,w=void 0===v?"":v,this.sendServiceConfirmation(p,w).catch((function(e){return console.error("Service Confirmation Error:",e)})),f)throw new m(f.name+": "+f.message);return[2,w]}}))}))},e.prototype.sendServiceConfirmation=function(e,t){return r(this,void 0,void 0,(function(){var n,s,o,i,r,h;return a(this,(function(a){switch(a.label){case 0:return this.pending_confirms[e]=!0,o=(s=d.Codec.Digest).encode,[4,d.sha256(l.default(t))];case 1:return n=o.apply(s,[a.sent()]),i={response_hash:n,client_metrics:{duration:"1s"}},r=this.getSignature(i),this.logMessage("Confirmation signature:",r),[4,this.conn.call("holo/service/confirm",[e,i,r])];case 2:if(h=a.sent(),this.logMessage("Service confirmation response:",h),!0!==h)throw h.error&&"HoloError"===h.error.name?new Error(h.error.message):new Error(h.error);return this.logMessage("Complete pending confirmation:",e),delete this.pending_confirms[e],[2,h]}}))}))},e.prototype.close=function(){return r(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.disconnect()];case 1:return e.sent(),[2]}}))}))},e.prototype.websocket=function(){return this.opened||this.logMessage("WARN: Returned WebSocket is not open and may be replaced by rpc-websocket library once open"),p?this.conn.socket.socket:this.conn.socket},e.prototype.agentId=function(){if("string"!=typeof this.agent_id)throw new Error("Agend ID should be a string starting with HcS.  Found '"+this.agent_id+"' ("+typeof this.agent_id+")");return!0===this.anonymous?"anonymous":this.agent_id},e.prototype.hostId=function(){if(this.opts.host_agent_id)return this.logMessage("Return configured host ID:",this.opts.host_agent_id),this.opts.host_agent_id;this.logMessage("Derive host ID from URL:",this.host);var e=this.host.split(".");return d.Codec.AgentId.encode(d.Codec.Base36.decode(e[0]))},e.prototype.happHost=function(){try{var e=window.location!=window.parent.location?document.referrer:document.location.href;return new URL(e).host}catch(e){console.error(String(e))}},e.prototype.getSignature=function(e){var t;if("string"==typeof e)t=d.Codec.Signature.decode(e);else{var n=l.default(e);this.logMessage("Serialized message:",n),t=(new TextEncoder).encode(n)}this.logMessage("Serialized data to be signed:",t);var s=this.keys.sign(t);return d.Codec.Signature.encode(s)},e.prototype.logMessage=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.opts.debug&&console.log.apply(console,e.map((function(e){if("string"!=typeof e)try{return"Object"===e.constructor.name||Array.isArray(e)?JSON.stringify(e,null,4):e.constructor.name}catch(e){}return e})))},e.prototype.requestServiceSignature=function(e){return r(this,void 0,void 0,(function(){var t,n,s,o;return a(this,(function(i){switch(i.label){case 0:return t=JSON.parse(JSON.stringify(e)),n=l.default(t.call_spec.args),[4,d.sha256(n)];case 1:return s=i.sent(),o=d.Codec.Digest.encode(s),t.call_spec.args_hash=o,delete t.call_spec.args,delete t.call_spec.instance_id,[2,this.getSignature(t)]}}))}))},e.PRODUCT=0,e.DEVELOP=1,e.HCC=2,e.DEFAULTS={mode:e.PRODUCT,port:4656,ssl:!1,path:"/hosting/",timeout:5e3,debug:!1,comb:!0},e.COMB=f,e}();t.Chaperone=C,t.deriveKeys=function(e,t,n){return s.from(d.deriveSeedFrom(d.Codec.Digest.decode(e),t,n)),new d.KeyManager(this.seed)}}).call(this,n(9),n(4).Buffer)},22:function(e,t){class n extends Error{constructor(e,t,...s){super(e),Error.captureStackTrace&&Error.captureStackTrace(this,n),this.name="TimeoutError",this.timeout=t}}function s(e,t=2e3){return new Promise(async(s,o)=>{const i=setTimeout(()=>{o(new n("Waited for "+t/1e3+" seconds",t))},t);try{s(await e())}catch(e){o(e)}finally{clearTimeout(i)}})}s.TimeoutError=n,e.exports=s},27:function(e,t,n){const s=n(28).Client,o=n(22),{TimeoutError:i}=o;e.exports=class extends s{opened(e=1e3){return o(()=>new Promise((e,t)=>this.on("open",e)),e)}closed(e=1e3){return o(()=>new Promise((e,t)=>this.on("close",()=>{e()})),e)}}},55:function(e,t,n){"use strict";(function(e){var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(o,i){function r(e){try{h(s.next(e))}catch(e){i(e)}}function a(e){try{h(s.throw(e))}catch(e){i(e)}}function h(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}h((s=s.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,s,o,i,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(o=2&i[0]?s.return:i[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,i[1])).done)return o;switch(s=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,s=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(o=(o=r.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){r.label=i[1];break}if(6===i[0]&&r.label<o[1]){r.label=o[1],o=i;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(i);break}o[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],s=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};t.__esModule=!0;var i=n(56);t.Codec=i.Codec,t.KeyManager=i.KeyManager,t.deriveSeedFrom=i.deriveSeedFrom;t.sha256=function(t){return s(void 0,void 0,void 0,(function(){var n,s;return o(this,(function(o){switch(o.label){case 0:return void 0!==crypto.subtle?[3,1]:[2,crypto.createHash("sha256").update(e.from(t)).digest()];case 1:return s=(n=e).from,[4,crypto.subtle.digest("SHA-256",e.from(t))];case 2:return[2,s.apply(n,[o.sent()])]}}))}))}}).call(this,n(4).Buffer)}}]);